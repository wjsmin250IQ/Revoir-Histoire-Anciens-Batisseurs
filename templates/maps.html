{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <!-- Titre de la page -->
    <h2 class="mb-4">Carte Interactive</h2>

    <!-- Section de la carte -->
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5>Emplacement actuel et carte interactive</h5>
                </div>
                <div class="card-body">
                    <!-- Espace pour une carte interactive (par exemple, avec Leaflet ou Google Maps) -->
                    <div id="map" style="height: 500px;">
                        <!-- La carte sera insérée ici par JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section des filtres pour la carte -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>Filtres de Carte</h5>
                </div>
                <div class="card-body">
                    <!-- Exemple de filtres -->
                    <form>
                        <div class="form-group mb-3">
                            <label for="filter_category">Catégorie</label>
                            <select class="form-control" id="filter_category">
                                <option value="">Sélectionner une catégorie</option>
                                <option value="historique">Historique</option>
                                <option value="monument">Monument</option>
                                <option value="parc">Parc</option>
                            </select>
                        </div>

                        <div class="form-group mb-3">
                            <label for="filter_range">Plage de Distance</label>
                            <input type="range" class="form-control" id="filter_range" min="0" max="100" value="50">
                        </div>

                        <button type="submit" class="btn btn-primary">Appliquer les filtres</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Section d'informations supplémentaires -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>Informations Complémentaires</h5>
                </div>
                <div class="card-body">
                    <p>Cette carte vous permet de visualiser les différents sites historiques et monuments autour de vous. Utilisez les filtres pour affiner votre recherche.</p>
                    <p>Utilisez le zoom pour explorer différentes zones et découvrez des informations supplémentaires sur les lieux d'intérêt.</p>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- Ajoutez le script pour intégrer la carte -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
<script>
    // Initialiser la carte
    var map = L.map('map').setView([51.505, -0.09], 13); // Remplacez les coordonnées par celles de votre emplacement de départ

    // Ajouter une couche de tuiles (utilisation de OpenStreetMap ici)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Ajouter un marqueur initial
    var marker = L.marker([51.5, -0.09]).addTo(map);
    marker.bindPopup("<b>Emplacement initial</b><br />Bienvenue sur la carte!").openPopup();
</script>

<!-- Code pour afficher dynamiquement des images dans différents formats -->
<script>
    // Fonction pour vérifier le support WebP
    function supportsWebP() {
        return new Promise(resolve => {
            const img = new Image();
            img.onload = img.onerror = () => resolve(img.height === 2);
            img.src = 'data:image/webp;base64,UklGRi4AAABXRUJQVlA4TAIAF4QAqQAA3R5cM9tQJlCUgAAAABkJYAzFF52FS1HrdZQ==';
        });
    }

    // Changer dynamiquement les images en fonction du support du format
    supportsWebP().then(supported => {
        const imgElements = document.querySelectorAll('img');
        imgElements.forEach(img => {
            if (supported) {
                // Si WebP est supporté, charger des images WebP
                img.src = img.src.replace(/\.(jpg|jpeg|png|gif)$/i, '.webp');
            } else {
                // Si WebP n'est pas supporté, charger une image JPEG
                img.src = img.src.replace(/\.(webp)$/i, '.jpg');
            }
        });
    });
</script>

{% endblock %}
